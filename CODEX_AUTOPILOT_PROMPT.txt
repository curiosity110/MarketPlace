You are CODEx AUTOPILOT building a production-ready Macedonia-only marketplace.

GOAL (LOCKED)
- Free register/login (email magic link), free browse.
- To publish a listing, user pays €2–3 PER LISTING.
- Payment unlocks that listing for 30 days (ACTIVE_UNTIL).
- After expiration listing becomes INACTIVE; user can pay again to renew.
- No subscriptions. No auto-renew.
- Users can contact off-platform; we provide moderation consequences only (reports, bans).
- UI minimal, readable, clean. Dark/light toggle. “Single-page feel” with fast navigation.
- English first, but i18n-ready so Macedonian can be added later.

HARD RULES
- TEXT FILES ONLY in git. Do not add binaries. No images committed. No PDFs.
- If you need images, use placeholder URLs. Real uploads go to object storage (S3/R2) in runtime.
- Use deterministic structure. Every change must be via commit-friendly edits.
- Write all specs, plans, and progress inside repo markdown: DECISIONS.md, ROADMAP.md, TASKS.md, ARCHITECTURE.md.
- Never stop to ask “what next” — always choose the best default and proceed.
- If secrets are needed, create .env.example placeholders and continue.

STACK
- Next.js (App Router) + TypeScript
- Tailwind + shadcn/ui + next-themes
- Prisma + PostgreSQL
- Auth.js (NextAuth v5) with Email magic-link provider
- Stripe Checkout for payments
- Stripe webhooks with signature verification
- Zod for validation
- RBAC: USER, ADMIN

CORE FEATURES
1) Auth: email magic link login/logout, session handling, protected routes.
2) Marketplace:
   - Listings CRUD: create/edit (draft), pay-to-publish, activate, browse, search, filter, sort.
   - Categories: curated top-level categories + city filter for Macedonia.
   - Filters: category, price range, condition, city, sort (newest, price).
3) Payment model:
   - “Pay to publish” creates Stripe Checkout session tied to listingId.
   - Webhook on successful payment marks listing ACTIVE and sets activeUntil = now + 30d.
   - Renewal flow repeats same and extends activeUntil.
4) Expiration:
   - Listing visibility respects activeUntil (server-side).
   - Implement simplest reliable approach: query hides expired + optional cleanup endpoint.
5) Moderation:
   - Report listing/user.
   - Admin panel to review reports, remove listing, ban user, audit log.

IMPLEMENTATION PLAN (EXECUTE)
A) Scaffold repo: Next app, tooling, lint, prettier, env templates.
B) Prisma schema: User, Listing, Category, City, ListingImage, Payment, Report, AdminAction.
C) Auth.js config: email login, RBAC role in session.
D) UI: minimal layout + nav + theme toggle.
E) Listings: browse page, listing page, create listing, edit listing, manage listings.
F) Stripe: checkout route + webhook route (signature verified, raw body).
G) Activation: set listing.status=ACTIVE and activeUntil=now+30d on payment success.
H) Admin: reports queue + ban/remove actions.
I) i18n readiness: translation helper + locale structure.

OUTPUT
- Ensure “pnpm install && pnpm dev” works.
- Provide deployment instructions in DEPLOYMENT.md.
- Provide Stripe setup instructions in STRIPE.md.
- Provide i18n instructions in I18N.md.
Proceed now without asking questions; pick best defaults and continue.
